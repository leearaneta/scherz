["^ ","~:output",["^ ","~:js","goog.provide('scherz.gravity');\nscherz.gravity.compress = (function scherz$gravity$compress(notes){\nif(cljs.core.truth_(cljs.core.some((function (p1__7843_SHARP_){\nreturn (p1__7843_SHARP_ < (12));\n}),notes))){\nreturn notes;\n} else {\nreturn cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__7844_SHARP_){\nreturn (p1__7844_SHARP_ - (12));\n}),notes);\n}\n});\nscherz.gravity.invert_asc = (function scherz$gravity$invert_asc(notes){\nreturn cljs.core.sort.cljs$core$IFn$_invoke$arity$1(cljs.core.cons((cljs.core.first(notes) + (12)),cljs.core.next(notes)));\n});\nscherz.gravity.invert_desc = (function scherz$gravity$invert_desc(notes){\nreturn cljs.core.sort.cljs$core$IFn$_invoke$arity$1(cljs.core.cons((cljs.core.last(notes) - (12)),cljs.core.next(cljs.core.reverse(notes))));\n});\nscherz.gravity.invert = (function scherz$gravity$invert(notes,shift){\nwhile(true){\nif((shift === (0))){\nreturn notes;\n} else {\nif((shift > (0))){\nvar G__7857 = scherz.gravity.invert_asc(notes);\nvar G__7858 = (shift - (1));\nnotes = G__7857;\nshift = G__7858;\ncontinue;\n} else {\nif((shift < (0))){\nvar G__7860 = scherz.gravity.invert_desc(notes);\nvar G__7861 = (shift + (1));\nnotes = G__7860;\nshift = G__7861;\ncontinue;\n} else {\nreturn null;\n}\n}\n}\nbreak;\n}\n});\n/**\n * Measures, from 0 to 1, how spatially close two chords are given a transition.\n *   More half step resolutions results in higher gravity.\n */\nscherz.gravity.chord_gravity = (function scherz$gravity$chord_gravity(source_notes,target_notes){\nvar compress = (function (notes){\nreturn cljs.core.sort.cljs$core$IFn$_invoke$arity$1(cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__7848_SHARP_){\nreturn cljs.core.mod(p1__7848_SHARP_,(12));\n}),notes)));\n});\nif(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(compress(source_notes),compress(target_notes))){\nreturn null;\n} else {\nreturn scherz.util.avg(cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.partial.cljs$core$IFn$_invoke$arity$2(cljs.core._SLASH_,(1)),cljs.core.map.cljs$core$IFn$_invoke$arity$2(scherz.util.abs,cljs.core.filter.cljs$core$IFn$_invoke$arity$2(cljs.core.partial.cljs$core$IFn$_invoke$arity$2(cljs.core.not_EQ_,(0)),cljs.core.map.cljs$core$IFn$_invoke$arity$3(cljs.core._,source_notes,target_notes)))));\n}\n});\n/**\n * Finds the inversion of a set of notes given the root.\n */\nscherz.gravity.inversion = (function scherz$gravity$inversion(root,notes){\nvar notes__$1 = notes;\nvar inversion = (0);\nwhile(true){\nif(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.mod(cljs.core.first(notes__$1),(12)),root)){\nreturn inversion;\n} else {\nvar G__7865 = scherz.gravity.invert_desc(notes__$1);\nvar G__7866 = (inversion + (1));\nnotes__$1 = G__7865;\ninversion = G__7866;\ncontinue;\n}\nbreak;\n}\n});\n","~:ns-info",["^ ","~:rename-macros",null,"~:renames",["^ "],"~:meta",["^ ","~:file","scherz/gravity.cljc","~:line",1,"~:column",5,"~:end-line",1,"~:end-column",19],"~:ns-aliases",["^ ","~$cljs.loader","~$shadow.loader"],"~:use-macros",null,"~:excludes",["~#set",[]],"~:name","~$scherz.gravity","~:op","~:ns","~:imports",null,"~:requires",["^ ","~$scherz.util","^G","~$cljs.core","^H","~$goog","^I"],"~:seen",["^@",["~:require"]],"~:uses",["^ ","~$abs","^G","~$avg","^G"],"~:require-macros",["^ ","^H","^H"],"~:form",["~#list",["~$ns","^B",["^Q",["^K",["^G","~:refer",["^M","^N"]]]]]],"~:flags",["^ ","^K",["^@",[]]],"~:js-deps",["^ "],"~:deps",["^I","^H","^G"]],"^D","^B","~:resource-id",["~:shadow.build.classpath/resource","scherz/gravity.cljc"],"~:compiled-at",1566598998614,"~:resource-name","scherz/gravity.cljc","~:warnings",[],"~:source","(ns scherz.gravity\n  (:require [scherz.util :refer [abs avg]]))\n\n(defn compress [notes]\n  ; recursively subtract 12 from every note\n  (if (some #(< % 12) notes)\n    notes\n    (map #(- % 12) notes)))\n\n(defn- invert-asc [notes]\n  (sort (cons (+ (first notes) 12)\n              (next notes))))\n\n(defn- invert-desc [notes]\n  (sort (cons (- (last notes) 12)\n              (next (reverse notes)))))\n\n(defn invert\n  [notes shift]\n  (cond\n    (zero? shift) notes\n    (pos? shift) (recur (invert-asc notes) (dec shift))\n    (neg? shift) (recur (invert-desc notes) (inc shift))))\n\n(defn chord-gravity\n  \"Measures, from 0 to 1, how spatially close two chords are given a transition.\n  More half step resolutions results in higher gravity.\"\n  [source-notes target-notes]\n  (let [compress (fn [notes] (sort (distinct (map #(mod % 12) notes))))]\n    (if (= (compress source-notes) (compress target-notes))\n      nil\n      (->> target-notes\n           (map - source-notes)\n           (filter (partial not= 0))\n           (map abs)\n           (map (partial / 1))\n           avg))))\n\n(defn inversion\n  \"Finds the inversion of a set of notes given the root.\"\n  [root notes]\n  (loop [notes notes\n         inversion 0]\n    (if (-> (first notes) (mod 12) (= root))\n      inversion\n      (recur (invert-desc notes) (inc inversion)))))\n","~:reader-features",["^@",["~:cljs"]],"~:cljc",true,"~:source-map-compact",["^ ","mappings",";AAGA,AAAA,AAAMA,AAAUC;AAAhB,AAEE,AAAI,AAAA,AAAAC,AAACC;AAAD,AAAO,AAAAD,AAAA;AAASD;AAClBA;;AACA,AAAA,AAAAG,AAACC;AAAD,AAAM,AAAAD,AAAA;AAASH;;;AAEnB,AAAA,AAAOK,AAAYL;AAAnB,AACE,AAACM,AAAK,AAACC,AAAK,AAAA,AAAG,AAACC,AAAMR,AACV,AAACS,AAAKT;;AAEpB,AAAA,AAAOU,AAAaV;AAApB,AACE,AAACM,AAAK,AAACC,AAAK,AAAA,AAAG,AAACI,AAAKX,AACT,AAACS,AAAK,AAACG,AAAQZ;;AAE7B,AAAA,AAAMa,AACHb,AAAMc;;AADT,AAEE,AACE,AAAA,AAAOA;AAAOd;;AADhB,AAEE,AAAA,AAAMc;AAAO,AAAO,AAACT,AAAWL;AAAO,AAAA,AAAKc;;;;;AAF9C,AAGE,AAAA,AAAMA;AAAO,AAAO,AAACJ,AAAYV;AAAO,AAAA,AAAKc;;;;;AAH/C;;;;;;;AAKF;;;;AAAA,AAAMC,AAGHC,AAAaC;AAHhB,AAIE,AAAMC,AAAS,AAAKlB;AAAL,AAAY,AAACM,AAAK,AAACa,AAAS,AAAA,AAAAC,AAAChB;AAAD,AAAM,AAAAgB,AAAA,AAACC;AAAUrB;;AAA5D,AACE,AAAI,AAACsB,AAAE,AAACJ,AAASF,AAAc,AAACE,AAASD;AAAzC;;AAEE,AAAKA,AACA,AAACM,AAAIC,AAAER,AACP,AAACS,AAAO,AAAA,AAACC,AAAQC,AACjB,AAACvB,AAAIwB,AACL,AAACxB,AAAI,AAAAyB,AAAA,AAACH,AACNI;;;AAEX;;;AAAA,AAAMC,AAEHC,AAAKhC;AAFR,AAGE,AAAOA,AAAMA;AAAb,AACOiC;;AADP,AAEE,AAAQ,AAACzB,AAAMR,AAAO,AAAA,AAACqB,AAAQ,AAACC,AAAEU;AAChCC;;AACA,AAAO,AAACvB,AAAYV;AAAO,AAAA,AAAKiC","names",["scherz.gravity/compress","notes","p1__7843#","cljs.core/some","p1__7844#","cljs.core.map.cljs$core$IFn$_invoke$arity$2","scherz.gravity/invert-asc","cljs.core.sort.cljs$core$IFn$_invoke$arity$1","cljs.core/cons","cljs.core/first","cljs.core/next","scherz.gravity/invert-desc","cljs.core/last","cljs.core/reverse","scherz.gravity/invert","shift","scherz.gravity/chord-gravity","source-notes","target-notes","compress","cljs.core.distinct.cljs$core$IFn$_invoke$arity$1","p1__7848#","cljs.core/mod","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","cljs.core.map.cljs$core$IFn$_invoke$arity$3","cljs.core/-","cljs.core.filter.cljs$core$IFn$_invoke$arity$2","cljs.core.partial.cljs$core$IFn$_invoke$arity$2","cljs.core/not=","scherz.util/abs","cljs.core//","scherz.util/avg","scherz.gravity/inversion","root","inversion"]]],"~:cache-keys",["~#cmap",[["^X","goog/math/math.js"],[1565449510000,"~:shadow.build.compiler/resolve",["^ ","~:require-id",null,"~:deps-ids",["^@",[]],"~:deps-syms",["^I","~$goog.array","~$goog.asserts"]]],["^X","goog/array/array.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I","^1>"]]],["^X","goog/debug/error.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I"]]],["^X","goog/dom/nodetype.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I"]]],["^X","goog/object/object.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I"]]],"~:SHADOW-TIMESTAMP",[1565449511000,1565449509000],["^X","scherz/gravity.cljc"],[1566527536000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I","^H","^G"]]],["^X","goog/math/long.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I","^1>","~$goog.reflect"]]],["^X","goog/string/internal.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I"]]],["^X","goog/functions/functions.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I"]]],["^X","goog/structs/map.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I","~$goog.iter.Iterator","~$goog.iter.StopIteration"]]],["^X","goog/asserts/asserts.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I","~$goog.debug.Error","~$goog.dom.NodeType"]]],["^X","goog/uri/uri.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I","^1=","^1>","~$goog.string","~$goog.structs","~$goog.structs.Map","~$goog.uri.utils","~$goog.uri.utils.ComponentIndex","~$goog.uri.utils.StandardQueryParam"]]],["^X","goog/base.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",[]]],["^X","goog/structs/structs.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I","^1=","~$goog.object"]]],["^X","goog/string/string.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I","~$goog.string.internal"]]],["^X","goog/reflect/reflect.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I"]]],["^X","goog/string/stringbuffer.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I"]]],["^X","goog/iter/iter.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I","^1=","^1>","~$goog.functions","~$goog.math"]]],["^X","cljs/core.cljs"],[1565449509000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["~$goog.math.Long","~$goog.math.Integer","^1E","^1K","^1=","~$goog.Uri","~$goog.string.StringBuffer"]]],["^X","goog/math/integer.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I"]]],["^X","goog/uri/utils.js"],[1565449510000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I","^1=","^1>","^1E"]]],["^X","scherz/util.cljc"],[1566527536000,"^19",["^ ","^1:",null,"^1;",["^@",[]],"^1<",["^I","^H"]]]]],"~:clj-info",["^ ","jar:file:/Users/mochi/.m2/repository/org/clojure/clojure/1.10.1/clojure-1.10.1.jar!/clojure/string.clj",1565449508000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/env.cljc",1565449509000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/source_map/base64.clj",1565449509000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/compiler.cljc",1565449509000,"jar:file:/Users/mochi/.m2/repository/org/clojure/tools.reader/1.3.2/tools.reader-1.3.2.jar!/clojure/tools/reader/reader_types.clj",1565449508000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/util.cljc",1565449509000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/js_deps.cljc",1565449509000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojure/1.10.1/clojure-1.10.1.jar!/clojure/java/io.clj",1565449508000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/analyzer.cljc",1565449509000,"jar:file:/Users/mochi/.m2/repository/org/clojure/tools.reader/1.3.2/tools.reader-1.3.2.jar!/clojure/tools/reader.clj",1565449508000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojure/1.10.1/clojure-1.10.1.jar!/clojure/set.clj",1565449508000,"jar:file:/Users/mochi/.m2/repository/org/clojure/tools.reader/1.3.2/tools.reader-1.3.2.jar!/clojure/tools/reader/impl/inspect.clj",1565449508000,"jar:file:/Users/mochi/.m2/repository/org/clojure/tools.reader/1.3.2/tools.reader-1.3.2.jar!/clojure/tools/reader/impl/errors.clj",1565449508000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/tagged_literals.cljc",1565449509000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/source_map.clj",1565449509000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojure/1.10.1/clojure-1.10.1.jar!/clojure/edn.clj",1565449508000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojure/1.10.1/clojure-1.10.1.jar!/clojure/pprint.clj",1565449508000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/externs.clj",1565449509000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/source_map/base64_vlq.clj",1565449509000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojure/1.10.1/clojure-1.10.1.jar!/clojure/instant.clj",1565449508000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojure/1.10.1/clojure-1.10.1.jar!/clojure/core.clj",1565449508000,"jar:file:/Users/mochi/.m2/repository/org/clojure/clojurescript/1.10.520/clojurescript-1.10.520.jar!/cljs/core.cljc",1565449509000,"jar:file:/Users/mochi/.m2/repository/org/clojure/data.json/0.2.6/data.json-0.2.6.jar!/clojure/data/json.clj",1565033122000,"jar:file:/Users/mochi/.m2/repository/org/clojure/tools.reader/1.3.2/tools.reader-1.3.2.jar!/clojure/tools/reader/default_data_readers.clj",1565449508000],"~:analyzer",["^ ","^3",null,"^4",["^ "],"^5",["^ ","^6","scherz/gravity.cljc","^7",1,"^8",5,"^9",1,"^:",19],"^;",["^ ","^<","^="],"^>",null,"^?",["^@",[]],"^A","^B","^E",null,"^F",["^ ","^G","^G","^H","^H","^I","^I"],"^J",["^@",["^K"]],"^L",["^ ","^M","^G","^N","^G"],"~:defs",["^ ","~$compress",["^ ","~:protocol-inline",null,"^5",["^ ","^6","scherz/gravity.cljc","^7",4,"^8",7,"^9",4,"^:",15,"~:arglists",["^Q",["~$quote",["^Q",[["~$notes"]]]]]],"^A","~$scherz.gravity/compress","^6","scherz/gravity.cljc","^:",15,"~:method-params",["^Q",[["^2F"]]],"~:protocol-impl",null,"~:arglists-meta",["^Q",[null,null]],"^8",1,"~:variadic?",false,"^7",4,"~:ret-tag",["^@",[null,"~$cljs.core/LazySeq"]],"^9",4,"~:max-fixed-arity",1,"~:fn-var",true,"^2D",["^Q",["^2E",["^Q",[["^2F"]]]]]],"~$invert-asc",["^ ","^2C",null,"^5",["^ ","^6","scherz/gravity.cljc","^7",10,"^8",8,"^9",10,"^:",18,"~:private",true,"^2D",["^Q",["^2E",["^Q",[["^2F"]]]]]],"^2Q",true,"^A","~$scherz.gravity/invert-asc","^6","scherz/gravity.cljc","^:",18,"^2H",["^Q",[["^2F"]]],"^2I",null,"^2J",["^Q",[null,null]],"^8",1,"^2K",false,"^7",10,"^2L","~$any","^9",10,"^2N",1,"^2O",true,"^2D",["^Q",["^2E",["^Q",[["^2F"]]]]]],"~$invert-desc",["^ ","^2C",null,"^5",["^ ","^6","scherz/gravity.cljc","^7",14,"^8",8,"^9",14,"^:",19,"^2Q",true,"^2D",["^Q",["^2E",["^Q",[["^2F"]]]]]],"^2Q",true,"^A","~$scherz.gravity/invert-desc","^6","scherz/gravity.cljc","^:",19,"^2H",["^Q",[["^2F"]]],"^2I",null,"^2J",["^Q",[null,null]],"^8",1,"^2K",false,"^7",14,"^2L","^2S","^9",14,"^2N",1,"^2O",true,"^2D",["^Q",["^2E",["^Q",[["^2F"]]]]]],"~$invert",["^ ","^2C",null,"^5",["^ ","^6","scherz/gravity.cljc","^7",18,"^8",7,"^9",18,"^:",13,"^2D",["^Q",["^2E",["^Q",[["^2F","~$shift"]]]]]],"^A","~$scherz.gravity/invert","^6","scherz/gravity.cljc","^:",13,"^2H",["^Q",[["^2F","^2W"]]],"^2I",null,"^2J",["^Q",[null,null]],"^8",1,"^2K",false,"^7",18,"^2L",["^@",[null,"~$clj-nil"]],"^9",18,"^2N",2,"^2O",true,"^2D",["^Q",["^2E",["^Q",[["^2F","^2W"]]]]]],"~$chord-gravity",["^ ","^2C",null,"^5",["^ ","^6","scherz/gravity.cljc","^7",25,"^8",7,"^9",25,"^:",20,"^2D",["^Q",["^2E",["^Q",[["~$source-notes","~$target-notes"]]]]],"~:doc","Measures, from 0 to 1, how spatially close two chords are given a transition.\n  More half step resolutions results in higher gravity."],"^A","~$scherz.gravity/chord-gravity","^6","scherz/gravity.cljc","^:",20,"^2H",["^Q",[["^2[","^30"]]],"^2I",null,"^2J",["^Q",[null,null]],"^8",1,"^2K",false,"^7",25,"^2L",["^@",["~$number","^2Y"]],"^9",25,"^2N",2,"^2O",true,"^2D",["^Q",["^2E",["^Q",[["^2[","^30"]]]]],"^31","Measures, from 0 to 1, how spatially close two chords are given a transition.\n  More half step resolutions results in higher gravity."],"~$inversion",["^ ","^2C",null,"^5",["^ ","^6","scherz/gravity.cljc","^7",39,"^8",7,"^9",39,"^:",16,"^2D",["^Q",["^2E",["^Q",[["~$root","^2F"]]]]],"^31","Finds the inversion of a set of notes given the root."],"^A","~$scherz.gravity/inversion","^6","scherz/gravity.cljc","^:",16,"^2H",["^Q",[["^35","^2F"]]],"^2I",null,"^2J",["^Q",[null,null]],"^8",1,"^2K",false,"^7",39,"^2L","^33","^9",39,"^2N",2,"^2O",true,"^2D",["^Q",["^2E",["^Q",[["^35","^2F"]]]]],"^31","Finds the inversion of a set of notes given the root."]],"^O",["^ ","^H","^H"],"^T",["^ ","^K",["^@",[]]],"^U",["^ "],"^V",["^I","^H","^G"]],"^D","^B","~:ns-specs",["^ "],"~:ns-speced-vars",[],"~:compiler-options",["^18",[["^39","~:static-fns"],true,["^39","~:elide-asserts"],true,["^39","~:optimize-constants"],null,["^39","^["],null,["^39","~:external-config"],null,["^39","~:tooling-config"],null,["^39","~:emit-constants"],null,["^39","~:load-tests"],false,["^39","~:infer-externs"],true,["^39","^11"],null,["~:js-options","~:js-provider"],"^K",["~:mode"],"~:release",["^39","~:fn-invoke-direct"],null,["^39","~:source-map"],null]]]